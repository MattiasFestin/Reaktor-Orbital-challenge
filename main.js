var epsilon = 0.01;
//[TODO] - Inline and unrole optimize for 3d case.
var Vec3 = (function () {
    function Vec3(arr) {
        /**
         * Assertions
         */
        if (!Array.isArray(arr)) {
            throw new TypeError('Invalid construtor parameter type. Array expected.');
        }
        if (arr.length !== 3) {
            throw new TypeError('Invalid construtor array length. Length 3 expected.');
        }
        this.value = new Float32Array(arr);
    }
    /**
     * Getters for 3d coordinates
     */
    Vec3.prototype.getX = function () {
        return this.value[0];
    };
    ;
    Vec3.prototype.getY = function () {
        return this.value[1];
    };
    ;
    Vec3.prototype.getZ = function () {
        return this.value[2];
    };
    ;
    Vec3.prototype.add = function (w) {
        var v = this;
        return new Vec3([
            this.getX() + w.getX(),
            this.getY() + w.getY(),
            this.getZ() + w.getZ(),
        ]);
    };
    Vec3.prototype.neg = function () {
        var v = this;
        return new Vec3([
            -this.getX(),
            -this.getY(),
            -this.getZ()
        ]);
    };
    Vec3.prototype.sub = function (w) {
        var v = this;
        return new Vec3([
            v.getX() - w.getX(),
            v.getY() - w.getY(),
            v.getZ() - w.getZ()
        ]);
    };
    Vec3.prototype.scale = function (a) {
        var v = this;
        return new Vec3([
            a * v.getX(),
            a * v.getY(),
            a * v.getZ()
        ]);
    };
    Vec3.prototype.dot = function (w) {
        var v = this;
        return v.getX() * w.getX() + v.getY() * w.getY() + v.getZ() * w.getZ();
    };
    Vec3.prototype.len = function () {
        return Math.sqrt(this.dot(this));
    };
    Vec3.prototype.norm = function () {
        var len = this.len();
        return len === 0 ? this : this.scale(1 / len);
    };
    Vec3.prototype.cross = function (w) {
        var v = this;
        return new Vec3([
            v.getY() * w.getZ() - v.getZ() * w.getY(),
            v.getZ() * w.getX() - v.getX() * w.getZ(),
            v.getX() * w.getY() - v.getY() * w.getX()
        ]);
    };
    Vec3.prototype.distance = function (w) {
        var v = this;
        return Math.sqrt(Math.pow(v.getX() - w.getX(), 2) +
            Math.pow(v.getY() - w.getY(), 2) +
            Math.pow(v.getZ() - w.getZ(), 2));
    };
    Vec3.prototype.toString = function () {
        return this.getX() + "," + this.getY() + "," + this.getZ();
    };
    return Vec3;
})();
var Line = (function () {
    function Line(o, d) {
        this.o = o;
        this.d = d.norm();
    }
    Line.prototype.getPoint = function (distance) {
        return this.o.add(this.d.scale(distance));
    };
    return Line;
})();
var Sphere = (function () {
    function Sphere(o, r) {
        this.o = o;
        this.r = r;
    }
    Sphere.prototype.pointOnSphere = function (p) {
        return Math.abs(p.distance(this.o) - this.r) < epsilon;
    };
    Sphere.prototype.normal = function (p) {
        return new Vec3([
            (p.getX() - this.o.getX()) / this.r,
            (p.getY() - this.o.getY()) / this.r,
            (p.getZ() - this.o.getZ()) / this.r
        ]);
    };
    Sphere.prototype.intersect = function (l) {
        var q = l.d.dot(l.o.sub(this.o)), t = Math.pow(q, 2) - Math.pow(l.o.distance(this.o), 2) + Math.pow(this.r, 2);
        if (t < 0 || (typeof t === 'number' && isNaN(t))) {
            return [];
        }
        else if (t === 0) {
            var x = l.getPoint(-q);
            if (!this.pointOnSphere(x)) {
                throw new Error("Solution points " + x + " not on sphere.");
            }
            return [x]; //One solution (Two points at same postion that tangent the sphere)
        }
        else {
            t = Math.sqrt(t);
            var x0 = l.getPoint(-q - t), x1 = l.getPoint(-q + t);
            if (!this.pointOnSphere(x0)) {
                throw new Error("Solution " + x0 + " point not on sphere.");
            }
            if (!this.pointOnSphere(x1)) {
                throw new Error("Solution " + x1 + " point not on sphere.");
            }
            return [x0, x1]; //Two unique solutions   
        }
    };
    return Sphere;
})();
var PolarCoordinate = (function () {
    function PolarCoordinate(lat, lon, alt) {
        this.lat = Math.PI * lat / 180;
        this.lon = Math.PI * lon / 180;
        this.alt = alt;
    }
    PolarCoordinate.prototype.convert = function () {
        return new Vec3([
            this.alt * Math.cos(this.lat) * Math.cos(this.lon),
            this.alt * Math.cos(this.lat) * Math.sin(this.lon),
            this.alt * Math.sin(this.lat)
        ]);
    };
    return PolarCoordinate;
})();
var RountingPointPairs = (function () {
    function RountingPointPairs(source, target) {
        this.source = source;
        this.target = target;
        this.distance = this.source.position.distance(this.target.position);
    }
    return RountingPointPairs;
})();
var RouteingPoint = (function () {
    function RouteingPoint(name, polarCoord) {
        this.name = name;
        this.position = polarCoord.convert();
    }
    return RouteingPoint;
})();
var Router = (function () {
    function Router(routes) {
        var _this = this;
        this.earth = new Sphere(new Vec3([0, 0, 0]), 6371);
        this.routes = routes
            .map(function (s) {
            s.availiableRoutingPoints = s.availiableRoutingPoints || [];
            if (['start', 'end'].indexOf(s.name) === -1) {
                s.availiableRoutingPoints = routes
                    .filter(function (q) {
                    return q !== s &&
                        ['start', 'end'].indexOf(q.name) === -1 &&
                        _this.earth.intersect(new Line(s.position, q.position.sub(s.position))).length === 0; //Is not self and does not intersect earth 
                })
                    .map(function (x) { return new RountingPointPairs(s, x); })
                    .filter(function (x) { return s.availiableRoutingPoints.indexOf(x) === -1; })
                    .sort(function (a, b) { return a.distance - b.distance; });
            }
            else {
                //Start and end points will intersect below (behind?) the point
                // We must check the surface normal the direction if it is infront of the point
                var surfaceNormal = _this.earth.normal(s.position);
                s.availiableRoutingPoints = s.availiableRoutingPoints.concat(routes
                    .filter(function (q) {
                    var dot = q.position.sub(s.position).norm().dot(surfaceNormal);
                    return q !== s &&
                        dot > 0;
                })
                    .map(function (x) { return new RountingPointPairs(s, x); })
                    .filter(function (x) { return s.availiableRoutingPoints.indexOf(x) === -1; })
                    .sort(function (a, b) { return a.distance - b.distance; }));
                //We want symetric relations
                s.availiableRoutingPoints.forEach(function (q) {
                    q.target.availiableRoutingPoints = q.target.availiableRoutingPoints || [];
                    if (q.target.availiableRoutingPoints.every(function (r) { return r.target !== q.source; })) {
                        q.target.availiableRoutingPoints.push(new RountingPointPairs(q.target, q.source));
                    }
                });
            }
            return s;
        });
    }
    Router.prototype.route = function (start, end) {
        var len = this.routes.length;
        var path = [];
        var pathPos = [];
        var distance = 0;
        var recursiveDecent = function (node, finish, answer, visited) {
            if (visited === void 0) { visited = []; }
            var availiableRoutingPoints = node.availiableRoutingPoints.filter(function (x) { return visited.indexOf(x) === -1; });
            if (availiableRoutingPoints.length === 0 || visited.length > 6) {
                return {
                    distance: Infinity,
                    path: ['NO_SOLUTION'],
                    pathPos: []
                };
            }
            else if (availiableRoutingPoints.map(function (x) { return x.target; }).indexOf(finish) > -1) {
                //[We are done]
                return {
                    distance: answer.distance,
                    path: answer.path.concat([node.name, finish.name]),
                    pathPos: answer.pathPos.concat([node.position, finish.position])
                };
            }
            else {
                var paths = availiableRoutingPoints
                    .filter(function (n) { return answer.path.indexOf(n.source.name) === -1; })
                    .map(function (n) { return recursiveDecent(n.target, finish, {
                    distance: answer.distance + n.distance,
                    path: answer.path.concat([n.source.name]),
                    pathPos: answer.pathPos.concat([n.source.position])
                }, visited.concat([n])); })
                    .filter(function (n) { return n && n.distance !== Infinity; });
                var best = paths.sort(function (a, b) { return a.distance - b.distance; })[0];
                return best;
            }
        };
        var answer = {
            path: path,
            pathPos: pathPos,
            distance: distance
        };
        answer = recursiveDecent(start, end, answer, []) || {
            path: path,
            pathPos: pathPos,
            distance: distance
        };
        console.log('answer:', answer);
        return answer;
    };
    Router.prototype.minimum = function (arr) {
        var minIndex = 0, minValue = arr[0];
        arr.forEach(function (x, i) {
            if (arr[i] < minValue) {
                minIndex = i;
                minValue = arr[i];
            }
        });
        return {
            index: minIndex,
            value: minValue
        };
    };
    return Router;
})();
//Helper function to parse data
var parse = function parseFn(text) {
    var result;
    var rows = text
        .split(/[\r\n]+/);
    var routeingPoints = rows
        .filter(function (x, i) { return i > 0 && i < rows.length - 1; })
        .map(function (row) {
        var values = row.split(',');
        return new RouteingPoint(values[0], new PolarCoordinate(+values[1], +values[2], +values[3] + 6371));
    });
    var earthPoints = rows[rows.length - 1].split(',');
    //[NOTE] - Add one to earth radious for altidude, to prevent to tangent intersection with sphere
    var start = new RouteingPoint('start', new PolarCoordinate(+earthPoints[1], +earthPoints[2], 6371));
    var end = new RouteingPoint('end', new PolarCoordinate(+earthPoints[3], +earthPoints[4], 6371));
    //Add start and end to routeingPoints
    routeingPoints.unshift(start);
    routeingPoints.push(end);
    var router = new Router(routeingPoints);
    var answer = router.route(start, end);
    var retVal = {
        seed: rows[0],
        routeingPoints: routeingPoints.map(function (x) {
            return {
                name: x.name,
                position: x.position,
                availiableRoutingPoints: x.availiableRoutingPoints.map(function (y) {
                    return {
                        name: y.target.name,
                        position: y.target.position
                    };
                })
            };
        }),
        start: {
            name: start.name,
            position: start.position,
            availiableRoutingPoints: start.availiableRoutingPoints.map(function (y) {
                return {
                    name: y.target.name,
                    position: y.target.position
                };
            })
        },
        end: {
            name: end.name,
            position: end.position,
            availiableRoutingPoints: end.availiableRoutingPoints.map(function (y) {
                return {
                    name: y.target.name,
                    position: y.target.position
                };
            })
        },
        answer: answer
    };
    console.log('result:', retVal);
    return retVal;
};
window.result = window.fetch('https://space-fast-track.herokuapp.com/generate')
    .then(function (x) { return x.text(); })
    .then(function (x) { return parse(x); });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOlsiVmVjMyIsIlZlYzMuY29uc3RydWN0b3IiLCJWZWMzLmdldFgiLCJWZWMzLmdldFkiLCJWZWMzLmdldFoiLCJWZWMzLmFkZCIsIlZlYzMubmVnIiwiVmVjMy5zdWIiLCJWZWMzLnNjYWxlIiwiVmVjMy5kb3QiLCJWZWMzLmxlbiIsIlZlYzMubm9ybSIsIlZlYzMuY3Jvc3MiLCJWZWMzLmRpc3RhbmNlIiwiVmVjMy50b1N0cmluZyIsIkxpbmUiLCJMaW5lLmNvbnN0cnVjdG9yIiwiTGluZS5nZXRQb2ludCIsIlNwaGVyZSIsIlNwaGVyZS5jb25zdHJ1Y3RvciIsIlNwaGVyZS5wb2ludE9uU3BoZXJlIiwiU3BoZXJlLm5vcm1hbCIsIlNwaGVyZS5pbnRlcnNlY3QiLCJQb2xhckNvb3JkaW5hdGUiLCJQb2xhckNvb3JkaW5hdGUuY29uc3RydWN0b3IiLCJQb2xhckNvb3JkaW5hdGUuY29udmVydCIsIlJvdW50aW5nUG9pbnRQYWlycyIsIlJvdW50aW5nUG9pbnRQYWlycy5jb25zdHJ1Y3RvciIsIlJvdXRlaW5nUG9pbnQiLCJSb3V0ZWluZ1BvaW50LmNvbnN0cnVjdG9yIiwiUm91dGVyIiwiUm91dGVyLmNvbnN0cnVjdG9yIiwiUm91dGVyLnJvdXRlIiwiUm91dGVyLm1pbmltdW0iLCJwYXJzZUZuIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUM7QUFHbkIsQUFEQSxrREFBa0Q7O0lBSTlDQSxjQUFZQSxHQUFhQTtRQUlyQkMsQUFIQUE7O1dBRUdBO1FBQ0hBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ3RCQSxNQUFNQSxJQUFJQSxTQUFTQSxDQUFDQSxvREFBb0RBLENBQUNBLENBQUNBO1FBQzlFQSxDQUFDQTtRQUVEQSxFQUFFQSxD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QSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtJQUMzRUEsQ0FBQ0E7SUFFTVQsa0JBQUdBLEdBQVZBO1FBQ0lVLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO0lBQ3JDQSxDQUFDQTtJQUVNVixtQkFBSUEsR0FBWEE7UUFDSVcsSUFBSUEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0E7UUFDckJBLE1BQU1BLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBLEdBQUdBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2xEQSxDQUFDQTtJQUVNWCxvQkFBS0EsR0FBWkEsVUFBY0EsQ0FBT0E7UUFDakJZLElBQUlBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBO1FBQ2JBLE1BQU1BLENBQUNBLElBQUlBLElBQUlBLENBQUNBO1lBQ1pBLENBQUNBLENBQUNBLElBQUlBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLEVBQUVBO1lBQ3pDQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQTtZQUN6Q0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsRUFBRUE7U0FDNUNBLENBQUNBLENBQUNBO0lBQ1BB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QUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEVBQzVCQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUVqRkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsS0FBS0EsUUFBUUEsSUFBSUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDL0NBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBO1FBQ2RBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ2pCQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUV2QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3pCQSxNQUFNQSxJQUFJQSxLQUFLQSxDQUFDQSxxQkFBbUJBLENBQUNBLG9CQUFpQkEsQ0FBQ0EsQ0FBQ0E7WUFDM0RBLENBQUNBO1lBRURBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEVBQUVBLG1FQUFtRUE7WUFBcEVBLEpBQ2ZBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ0pB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TUFBTUE7S0FDVEEsQ0FBQ0E7SUFFRkEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsU0FBU0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7SUFFL0JBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBO0FBQ2xCQSxDQUFDQSxDQUFDO0FBT0YsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLGlEQUFpRCxDQUFDO0tBQzFFLElBQUksQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBUixDQUFRLENBQUM7S0FDbkIsSUFBSSxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFSLENBQVEsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGVwc2lsb24gPSAwLjAxO1xyXG5cclxuLy9bVE9ET10gLSBJbmxpbmUgYW5kIHVucm9sZSBvcHRpbWl6ZSBmb3IgM2QgY2FzZS5cclxuY2xhc3MgVmVjMyB7XHJcbiAgICBwcml2YXRlIHZhbHVlOiBGbG9hdDMyQXJyYXk7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKGFycjogbnVtYmVyW10pIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBc3NlcnRpb25zXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFycikpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjb25zdHJ1dG9yIHBhcmFtZXRlciB0eXBlLiBBcnJheSBleHBlY3RlZC4nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoICE9PSAzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgY29uc3RydXRvciBhcnJheSBsZW5ndGguIExlbmd0aCAzIGV4cGVjdGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnZhbHVlID0gbmV3IEZsb2F0MzJBcnJheShhcnIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEdldHRlcnMgZm9yIDNkIGNvb3JkaW5hdGVzXHJcbiAgICAgKi8gICAgXHJcbiAgICBwdWJsaWMgZ2V0WCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVbMF07XHJcbiAgICB9O1xyXG5cclxuICAgIHB1YmxpYyBnZXRZICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZVsxXTtcclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIGdldFogKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlWzJdO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcHVibGljIGFkZCAodzogVmVjMykge1xyXG4gICAgICAgIHZhciB2ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzMoW1xyXG4gICAgICAgICAgICB0aGlzLmdldFgoKSArIHcuZ2V0WCgpLFxyXG4gICAgICAgICAgICB0aGlzLmdldFkoKSArIHcuZ2V0WSgpLFxyXG4gICAgICAgICAgICB0aGlzLmdldFooKSArIHcuZ2V0WigpLFxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgbmVnICgpIHtcclxuICAgICAgICB2YXIgdiA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKFsgXHJcbiAgICAgICAgICAgIC10aGlzLmdldFgoKSxcclxuICAgICAgICAgICAgLXRoaXMuZ2V0WSgpLFxyXG4gICAgICAgICAgICAtdGhpcy5nZXRaKClcclxuICAgICAgICBdKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIHN1YiAodzogVmVjMykge1xyXG4gICAgICAgIHZhciB2ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzMoW1xyXG4gICAgICAgICAgICB2LmdldFgoKSAtIHcuZ2V0WCgpLFxyXG4gICAgICAgICAgICB2LmdldFkoKSAtIHcuZ2V0WSgpLFxyXG4gICAgICAgICAgICB2LmdldFooKSAtIHcuZ2V0WigpXHJcbiAgICAgICAgXSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBzY2FsZSAoYTogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIHYgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjMyhbXHJcbiAgICAgICAgICAgIGEgKiB2LmdldFgoKSxcclxuICAgICAgICAgICAgYSAqIHYuZ2V0WSgpLFxyXG4gICAgICAgICAgICBhICogdi5nZXRaKClcclxuICAgICAgICBdKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIGRvdCAodzogVmVjMykge1xyXG4gICAgICAgIHZhciB2ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdi5nZXRYKCkgKiB3LmdldFgoKSArIHYuZ2V0WSgpICogdy5nZXRZKCkgKyB2LmdldFooKSAqIHcuZ2V0WigpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgbGVuKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy5kb3QodGhpcykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgbm9ybSAoKSB7XHJcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMubGVuKCk7XHJcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gMCA/IHRoaXMgOiB0aGlzLnNjYWxlKDEgLyBsZW4pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcm9zcyAodzogVmVjMykge1xyXG4gICAgICAgIHZhciB2ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzMoW1xyXG4gICAgICAgICAgICB2LmdldFkoKSAqIHcuZ2V0WigpIC0gdi5nZXRaKCkgKiB3LmdldFkoKSxcclxuICAgICAgICAgICAgdi5nZXRaKCkgKiB3LmdldFgoKSAtIHYuZ2V0WCgpICogdy5nZXRaKCksXHJcbiAgICAgICAgICAgIHYuZ2V0WCgpICogdy5nZXRZKCkgLSB2LmdldFkoKSAqIHcuZ2V0WCgpXHJcbiAgICAgICAgXSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBkaXN0YW5jZSh3OiBWZWMzKSB7XHJcbiAgICAgICAgdmFyIHYgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoXHJcbiAgICAgICAgICAgIE1hdGgucG93KHYuZ2V0WCgpIC0gdy5nZXRYKCksIDIpICtcclxuICAgICAgICAgICAgTWF0aC5wb3codi5nZXRZKCkgLSB3LmdldFkoKSwgMikgK1xyXG4gICAgICAgICAgICBNYXRoLnBvdyh2LmdldFooKSAtIHcuZ2V0WigpLCAyKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyB0b1N0cmluZygpIHtcclxuICAgICAgICByZXR1cm4gYCR7dGhpcy5nZXRYKCl9LCR7dGhpcy5nZXRZKCl9LCR7dGhpcy5nZXRaKCl9YDtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgTGluZSB7XHJcbiAgICBwdWJsaWMgbzogVmVjMztcclxuICAgIHB1YmxpYyBkOiBWZWMzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG86IFZlYzMsIGQ6IFZlYzMpIHtcclxuICAgICAgICB0aGlzLm8gPSBvO1xyXG4gICAgICAgIHRoaXMuZCA9IGQubm9ybSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgZ2V0UG9pbnQgKGRpc3RhbmNlOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vLmFkZCh0aGlzLmQuc2NhbGUoZGlzdGFuY2UpKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgU3BoZXJlIHtcclxuICAgIHB1YmxpYyBvOiBWZWMzO1xyXG4gICAgcHVibGljIHI6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihvOiBWZWMzLCByOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLm8gPSBvO1xyXG4gICAgICAgIHRoaXMuciA9IHI7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBwb2ludE9uU3BoZXJlIChwOiBWZWMzKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguYWJzKHAuZGlzdGFuY2UodGhpcy5vKSAtIHRoaXMucikgPCBlcHNpbG9uO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgbm9ybWFsIChwOiBWZWMzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKFtcclxuICAgICAgICAgICAgKHAuZ2V0WCgpIC0gdGhpcy5vLmdldFgoKSkgLyB0aGlzLnIsXHJcbiAgICAgICAgICAgIChwLmdldFkoKSAtIHRoaXMuby5nZXRZKCkpIC8gdGhpcy5yLFxyXG4gICAgICAgICAgICAocC5nZXRaKCkgLSB0aGlzLm8uZ2V0WigpKSAvIHRoaXMuclxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgaW50ZXJzZWN0IChsOiBMaW5lKSB7XHJcbiAgICAgICAgdmFyIHEgPSBsLmQuZG90KGwuby5zdWIodGhpcy5vKSksXHJcbiAgICAgICAgICAgIHQgPSBNYXRoLnBvdyhxLCAyKSAtIE1hdGgucG93KGwuby5kaXN0YW5jZSh0aGlzLm8pLCAyKSArIE1hdGgucG93KHRoaXMuciwgMik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGlmICh0IDwgMCB8fCAodHlwZW9mIHQgPT09ICdudW1iZXInICYmIGlzTmFOKHQpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfSBlbHNlIGlmICh0ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHZhciB4ID0gbC5nZXRQb2ludCgtcSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIXRoaXMucG9pbnRPblNwaGVyZSh4KSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTb2x1dGlvbiBwb2ludHMgJHt4fSBub3Qgb24gc3BoZXJlLmApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gW3hdOyAvL09uZSBzb2x1dGlvbiAoVHdvIHBvaW50cyBhdCBzYW1lIHBvc3Rpb24gdGhhdCB0YW5nZW50IHRoZSBzcGhlcmUpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdCA9IE1hdGguc3FydCh0KTtcclxuXHJcbiAgICAgICAgICAgIHZhciB4MCA9IGwuZ2V0UG9pbnQoLXEgLSB0KSxcclxuICAgICAgICAgICAgICAgIHgxID0gbC5nZXRQb2ludCgtcSArIHQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLnBvaW50T25TcGhlcmUoeDApKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNvbHV0aW9uICR7eDB9IHBvaW50IG5vdCBvbiBzcGhlcmUuYCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wb2ludE9uU3BoZXJlKHgxKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTb2x1dGlvbiAke3gxfSBwb2ludCBub3Qgb24gc3BoZXJlLmApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gW3gwLCB4MV07IC8vVHdvIHVuaXF1ZSBzb2x1dGlvbnMgICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFBvbGFyQ29vcmRpbmF0ZSB7XHJcbiAgICBwdWJsaWMgbGF0OiBudW1iZXI7XHJcbiAgICBwdWJsaWMgbG9uOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgYWx0OiBudW1iZXI7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yIChsYXQ6IG51bWJlciwgbG9uOiBudW1iZXIsIGFsdDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5sYXQgPSBNYXRoLlBJICogbGF0IC8gMTgwO1xyXG4gICAgICAgIHRoaXMubG9uID0gTWF0aC5QSSAqIGxvbiAvIDE4MDtcclxuICAgICAgICB0aGlzLmFsdCA9IGFsdDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIGNvbnZlcnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKFtcclxuICAgICAgICAgICAgdGhpcy5hbHQgKiBNYXRoLmNvcyh0aGlzLmxhdCkgKiBNYXRoLmNvcyh0aGlzLmxvbiksXHJcbiAgICAgICAgICAgIHRoaXMuYWx0ICogTWF0aC5jb3ModGhpcy5sYXQpICogTWF0aC5zaW4odGhpcy5sb24pLFxyXG4gICAgICAgICAgICB0aGlzLmFsdCAqIE1hdGguc2luKHRoaXMubGF0KVxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG59IFxyXG5cclxuY2xhc3MgUm91bnRpbmdQb2ludFBhaXJzIHtcclxuICAgIHB1YmxpYyBzb3VyY2U6IFJvdXRlaW5nUG9pbnQ7XHJcbiAgICBwdWJsaWMgdGFyZ2V0OiBSb3V0ZWluZ1BvaW50O1xyXG4gICAgcHVibGljIGRpc3RhbmNlOiBudW1iZXI7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yIChzb3VyY2U6IFJvdXRlaW5nUG9pbnQsIHRhcmdldDogUm91dGVpbmdQb2ludCkge1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMuZGlzdGFuY2UgPSB0aGlzLnNvdXJjZS5wb3NpdGlvbi5kaXN0YW5jZSh0aGlzLnRhcmdldC5wb3NpdGlvbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFJvdXRlaW5nUG9pbnQge1xyXG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcclxuICAgIHB1YmxpYyBwb3NpdGlvbjogVmVjMztcclxuICAgIFxyXG4gICAgLy9TYXRlbGl0ZXMgaW4gdmlldyBmcm9tIHRoaXMgb25lXHJcbiAgICBwdWJsaWMgYXZhaWxpYWJsZVJvdXRpbmdQb2ludHM6IFJvdW50aW5nUG9pbnRQYWlyc1tdO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHBvbGFyQ29vcmQ6IFBvbGFyQ29vcmRpbmF0ZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvbGFyQ29vcmQuY29udmVydCgpO1xyXG4gICAgfVxyXG59XHJcbmludGVyZmFjZSBJQW5zd2VyIHtcclxuICAgIGRpc3RhbmNlOiBudW1iZXIsXHJcbiAgICBwYXRoOiBzdHJpbmdbXSxcclxuICAgIHBhdGhQb3M6IFZlYzNbXVxyXG59XHJcbmNsYXNzIFJvdXRlciB7XHJcbiAgICBwdWJsaWMgcm91dGVzOiBSb3V0ZWluZ1BvaW50W107XHJcbiAgICBwdWJsaWMgZWFydGg6IFNwaGVyZTtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IgKHJvdXRlczogUm91dGVpbmdQb2ludFtdKSB7XHJcbiAgICAgICAgdGhpcy5lYXJ0aCA9IG5ldyBTcGhlcmUobmV3IFZlYzMoWzAsIDAsIDBdKSwgNjM3MSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yb3V0ZXMgPSByb3V0ZXNcclxuICAgICAgICAgICAgLm1hcChzID0+IHtcclxuICAgICAgICAgICAgICAgIHMuYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMgPSBzLmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYgKFsnc3RhcnQnLCAnZW5kJ10uaW5kZXhPZihzLm5hbWUpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMgPSByb3V0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihxID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxICE9PSBzICYmIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnc3RhcnQnLCAnZW5kJ10uaW5kZXhPZihxLm5hbWUpID09PSAtMSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWFydGguaW50ZXJzZWN0KG5ldyBMaW5lKHMucG9zaXRpb24sIHEucG9zaXRpb24uc3ViKHMucG9zaXRpb24pKSkubGVuZ3RoID09PSAwOyAvL0lzIG5vdCBzZWxmIGFuZCBkb2VzIG5vdCBpbnRlcnNlY3QgZWFydGggXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoeCA9PiBuZXcgUm91bnRpbmdQb2ludFBhaXJzKHMsIHgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1JlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoeCA9PiBzLmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLmluZGV4T2YoeCkgPT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL09yZGVyIGJ5IGRpc3RhbmNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmRpc3RhbmNlIC0gYi5kaXN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vU3RhcnQgYW5kIGVuZCBwb2ludHMgd2lsbCBpbnRlcnNlY3QgYmVsb3cgKGJlaGluZD8pIHRoZSBwb2ludFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG11c3QgY2hlY2sgdGhlIHN1cmZhY2Ugbm9ybWFsIHRoZSBkaXJlY3Rpb24gaWYgaXQgaXMgaW5mcm9udCBvZiB0aGUgcG9pbnRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VyZmFjZU5vcm1hbCA9IHRoaXMuZWFydGgubm9ybWFsKHMucG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHMuYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMgPSBzLmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLmNvbmNhdChcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIocSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG90ID0gcS5wb3NpdGlvbi5zdWIocy5wb3NpdGlvbikubm9ybSgpLmRvdChzdXJmYWNlTm9ybWFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxICE9PSBzICYmIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvdCA+IDAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoeCA9PiBuZXcgUm91bnRpbmdQb2ludFBhaXJzKHMsIHgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1JlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoeCA9PiBzLmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLmluZGV4T2YoeCkgPT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL09yZGVyIGJ5IGRpc3RhbmNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmRpc3RhbmNlIC0gYi5kaXN0YW5jZSlcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL1dlIHdhbnQgc3ltZXRyaWMgcmVsYXRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgcy5hdmFpbGlhYmxlUm91dGluZ1BvaW50cy5mb3JFYWNoKHEgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxLnRhcmdldC5hdmFpbGlhYmxlUm91dGluZ1BvaW50cyA9IHEudGFyZ2V0LmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocS50YXJnZXQuYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMuZXZlcnkociA9PiByLnRhcmdldCAhPT0gcS5zb3VyY2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnRhcmdldC5hdmFpbGlhYmxlUm91dGluZ1BvaW50cy5wdXNoKG5ldyBSb3VudGluZ1BvaW50UGFpcnMocS50YXJnZXQsIHEuc291cmNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTsgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHM7IFxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIHJvdXRlIChzdGFydDogUm91dGVpbmdQb2ludCwgZW5kOiBSb3V0ZWluZ1BvaW50KTogSUFuc3dlciB7XHJcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMucm91dGVzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgdmFyIHBhdGg6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgdmFyIHBhdGhQb3M6IFZlYzNbXSA9IFtdO1xyXG4gICAgICAgIHZhciBkaXN0YW5jZSA9IDA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgIHZhciByZWN1cnNpdmVEZWNlbnQgPSBmdW5jdGlvbiAobm9kZTogUm91dGVpbmdQb2ludCwgZmluaXNoOiBSb3V0ZWluZ1BvaW50LCBhbnN3ZXI6IElBbnN3ZXIsIHZpc2l0ZWQ6IFJvdW50aW5nUG9pbnRQYWlyc1tdICA9IFtdKTogSUFuc3dlciB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMgPSBub2RlLmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLmZpbHRlcih4ID0+IHZpc2l0ZWQuaW5kZXhPZih4KSA9PT0gLTEpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLmxlbmd0aCA9PT0gMCB8fCB2aXNpdGVkLmxlbmd0aCA+IDYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2U6IEluZmluaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IFsnTk9fU09MVVRJT04nXSxcclxuICAgICAgICAgICAgICAgICAgICBwYXRoUG9zOiBbXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhdmFpbGlhYmxlUm91dGluZ1BvaW50cy5tYXAoeCA9PiB4LnRhcmdldCkuaW5kZXhPZihmaW5pc2gpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vW1dlIGFyZSBkb25lXVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZTogYW5zd2VyLmRpc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGFuc3dlci5wYXRoLmNvbmNhdChbbm9kZS5uYW1lLCBmaW5pc2gubmFtZV0pLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhQb3M6IGFuc3dlci5wYXRoUG9zLmNvbmNhdChbbm9kZS5wb3NpdGlvbiwgZmluaXNoLnBvc2l0aW9uXSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aHMgPSBhdmFpbGlhYmxlUm91dGluZ1BvaW50c1xyXG4gICAgICAgICAgICAgICAgICAgIC8vUHJldmVudCBiYWNrdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG4gPT4gYW5zd2VyLnBhdGguaW5kZXhPZihuLnNvdXJjZS5uYW1lKSA9PT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAgLy9SZWN1cnNpdmUgZGVjZW50IGRvd24gY2hpbGQgbm9kZXNcclxuICAgICAgICAgICAgICAgICAgICAubWFwKG4gPT4gcmVjdXJzaXZlRGVjZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi50YXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2U6IGFuc3dlci5kaXN0YW5jZSArIG4uZGlzdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogYW5zd2VyLnBhdGguY29uY2F0KFtuLnNvdXJjZS5uYW1lXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aFBvczogYW5zd2VyLnBhdGhQb3MuY29uY2F0KFtuLnNvdXJjZS5wb3NpdGlvbl0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaXRlZC5jb25jYXQoW25dKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vV2Ugb25seSB3YW50IHNvbHV0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobiA9PiBuICYmIG4uZGlzdGFuY2UgIT09IEluZmluaXR5KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYmVzdCA9IHBhdGhzLnNvcnQoKGEsIGIpID0+IGEuZGlzdGFuY2UgLSBiLmRpc3RhbmNlKVswXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBiZXN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGFuc3dlciA9IHtcclxuICAgICAgICAgICAgcGF0aDogcGF0aCxcclxuICAgICAgICAgICAgcGF0aFBvczogcGF0aFBvcyxcclxuICAgICAgICAgICAgZGlzdGFuY2U6IGRpc3RhbmNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBhbnN3ZXIgPSByZWN1cnNpdmVEZWNlbnQoc3RhcnQsIGVuZCwgYW5zd2VyLCBbXSkgfHwge1xyXG4gICAgICAgICAgICBwYXRoOiBwYXRoLFxyXG4gICAgICAgICAgICBwYXRoUG9zOiBwYXRoUG9zLFxyXG4gICAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2VcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdhbnN3ZXI6JywgYW5zd2VyKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gYW5zd2VyO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIG1pbmltdW0gKGFycjogbnVtYmVyW10pIHtcclxuICAgICAgICB2YXIgbWluSW5kZXggPSAwLFxyXG4gICAgICAgICAgICBtaW5WYWx1ZSA9IGFyclswXTtcclxuXHJcbiAgICAgICAgYXJyLmZvckVhY2goKHgsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGFycltpXSA8IG1pblZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBtaW5JbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICBtaW5WYWx1ZSA9IGFycltpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluZGV4OiBtaW5JbmRleCxcclxuICAgICAgICAgICAgdmFsdWU6IG1pblZhbHVlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy9IZWxwZXIgZnVuY3Rpb24gdG8gcGFyc2UgZGF0YVxyXG52YXIgcGFyc2UgPSBmdW5jdGlvbiBwYXJzZUZuICh0ZXh0OiBzdHJpbmcpIHtcclxuICAgIHZhciByZXN1bHQ7XHJcbiAgICB2YXIgcm93cyA9IHRleHRcclxuICAgICAgICAuc3BsaXQoL1tcXHJcXG5dKy8pO1xyXG4gICAgXHJcbiAgICB2YXIgcm91dGVpbmdQb2ludHMgPSByb3dzXHJcbiAgICAgICAgLmZpbHRlcigoeCwgaSkgPT4gaSA+IDAgJiYgaSA8IHJvd3MubGVuZ3RoIC0gMSlcclxuICAgICAgICAubWFwKHJvdyA9PiB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSByb3cuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUm91dGVpbmdQb2ludCh2YWx1ZXNbMF0sIG5ldyBQb2xhckNvb3JkaW5hdGUoK3ZhbHVlc1sxXSwgK3ZhbHVlc1syXSwgK3ZhbHVlc1szXSArIDYzNzEpKTtcclxuICAgICAgICB9KTtcclxuICAgIHZhciBlYXJ0aFBvaW50cyA9IHJvd3Nbcm93cy5sZW5ndGgtMV0uc3BsaXQoJywnKTtcclxuICAgIFxyXG4gICAgLy9bTk9URV0gLSBBZGQgb25lIHRvIGVhcnRoIHJhZGlvdXMgZm9yIGFsdGlkdWRlLCB0byBwcmV2ZW50IHRvIHRhbmdlbnQgaW50ZXJzZWN0aW9uIHdpdGggc3BoZXJlXHJcbiAgICB2YXIgc3RhcnQgPSBuZXcgUm91dGVpbmdQb2ludCgnc3RhcnQnLCBuZXcgUG9sYXJDb29yZGluYXRlKCtlYXJ0aFBvaW50c1sxXSwgK2VhcnRoUG9pbnRzWzJdLCA2MzcxKSk7XHJcbiAgICB2YXIgZW5kID0gbmV3IFJvdXRlaW5nUG9pbnQoJ2VuZCcsIG5ldyBQb2xhckNvb3JkaW5hdGUoK2VhcnRoUG9pbnRzWzNdLCArZWFydGhQb2ludHNbNF0sIDYzNzEpKTtcclxuICAgIFxyXG4gICAgLy9BZGQgc3RhcnQgYW5kIGVuZCB0byByb3V0ZWluZ1BvaW50c1xyXG4gICAgcm91dGVpbmdQb2ludHMudW5zaGlmdChzdGFydCk7XHJcbiAgICByb3V0ZWluZ1BvaW50cy5wdXNoKGVuZCk7XHJcbiAgICBcclxuICAgIHZhciByb3V0ZXIgPSBuZXcgUm91dGVyKHJvdXRlaW5nUG9pbnRzKTtcclxuXHJcbiAgICB2YXIgYW5zd2VyID0gcm91dGVyLnJvdXRlKHN0YXJ0LCBlbmQpO1xyXG4gICAgXHJcbiAgICBcclxuICAgIHZhciByZXRWYWwgPSAge1xyXG4gICAgICAgIHNlZWQ6IHJvd3NbMF0sXHJcbiAgICAgICAgcm91dGVpbmdQb2ludHM6IHJvdXRlaW5nUG9pbnRzLm1hcCh4ID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHgubmFtZSxcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB4LnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgYXZhaWxpYWJsZVJvdXRpbmdQb2ludHM6IHguYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMubWFwKHkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHkudGFyZ2V0Lm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB5LnRhcmdldC5wb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHN0YXJ0OiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHN0YXJ0Lm5hbWUsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBzdGFydC5wb3NpdGlvbixcclxuICAgICAgICAgICAgYXZhaWxpYWJsZVJvdXRpbmdQb2ludHM6IHN0YXJ0LmF2YWlsaWFibGVSb3V0aW5nUG9pbnRzLm1hcCh5ID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogeS50YXJnZXQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogeS50YXJnZXQucG9zaXRpb25cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbmQ6IHtcclxuICAgICAgICAgICAgbmFtZTogZW5kLm5hbWUsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBlbmQucG9zaXRpb24sXHJcbiAgICAgICAgICAgIGF2YWlsaWFibGVSb3V0aW5nUG9pbnRzOiBlbmQuYXZhaWxpYWJsZVJvdXRpbmdQb2ludHMubWFwKHkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB5LnRhcmdldC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB5LnRhcmdldC5wb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFuc3dlclxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ3Jlc3VsdDonLCByZXRWYWwpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gcmV0VmFsO1xyXG59O1xyXG5cclxuaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICByZXN1bHQ6IGFueTtcclxuICAgIGZldGNoOiAodXJsOiBzdHJpbmcpID0+IGFueTtcclxufVxyXG5cclxud2luZG93LnJlc3VsdCA9IHdpbmRvdy5mZXRjaCgnaHR0cHM6Ly9zcGFjZS1mYXN0LXRyYWNrLmhlcm9rdWFwcC5jb20vZ2VuZXJhdGUnKVxyXG4gICAgLnRoZW4oeCA9PiB4LnRleHQoKSlcclxuICAgIC50aGVuKHggPT4gcGFyc2UoeCkpOyJdfQ==